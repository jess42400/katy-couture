<section class="cart-page">
  <h1 class="cart-page__title">{{ 'cart.title' | t }}</h1>

  {%- if cart.item_count > 0 -%}
    <form action="{{ routes.cart_url }}" method="post" class="cart-page__form">
      <div class="cart-page__items">
        {%- for item in cart.items -%}
          <div class="cart-item">
            <a href="{{ item.url }}" class="cart-item__image">
              {%- if item.image -%}
                {{ item.image | image_url: width: 200 | image_tag: loading: 'lazy' }}
              {%- else -%}
                <div class="cart-item__placeholder">
                  {{ 'product-1' | placeholder_svg_tag }}
                </div>
              {%- endif -%}
            </a>

            <div class="cart-item__details">
              <div class="cart-item__info">
                <a href="{{ item.url }}" class="cart-item__title">{{ item.product.title }}</a>

                {%- if item.variant.title != 'Default Title' -%}
                  <p class="cart-item__variant">{{ item.variant.title }}</p>
                {%- endif -%}

                <p class="cart-item__price">{{ item.price | money }}</p>
              </div>

              <div class="cart-item__quantity">
                <label class="visually-hidden" for="quantity-{{ item.key }}">{{ 'products.quantity' | t }}</label>
                <div class="cart-item__quantity-input">
                  <button type="button" class="cart-item__quantity-btn" data-quantity-minus data-key="{{ item.key }}">-</button>
                  <input
                    type="number"
                    name="updates[]"
                    id="quantity-{{ item.key }}"
                    value="{{ item.quantity }}"
                    min="0"
                    class="cart-item__quantity-field"
                    data-key="{{ item.key }}"
                  >
                  <button type="button" class="cart-item__quantity-btn" data-quantity-plus data-key="{{ item.key }}">+</button>
                </div>
              </div>

              <div class="cart-item__total">
                <span class="cart-item__line-price">{{ item.line_price | money }}</span>
              </div>

              <a href="{{ item.url_to_remove }}" class="cart-item__remove">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M18 6 6 18"/>
                  <path d="m6 6 12 12"/>
                </svg>
                <span class="visually-hidden">{{ 'cart.remove' | t }}</span>
              </a>
            </div>
          </div>
        {%- endfor -%}
      </div>

      <div class="cart-page__summary">
        <div class="cart-summary">
          <div class="cart-summary__row">
            <span>{{ 'cart.subtotal' | t }}</span>
            <span class="cart-summary__subtotal">{{ cart.total_price | money }}</span>
          </div>

          <p class="cart-summary__note">{{ 'cart.shipping_note' | t }}</p>

          <div class="cart-summary__actions">
            <button type="submit" name="update" class="btn btn--secondary cart-summary__update">
              {{ 'cart.update' | t }}
            </button>
            <button type="submit" name="checkout" class="btn btn--primary cart-summary__checkout">
              {{ 'cart.checkout' | t }}
            </button>
          </div>

          <a href="{{ routes.all_products_collection_url }}" class="cart-summary__continue">
            {{ 'cart.continue_shopping' | t }}
          </a>
        </div>
      </div>
    </form>
  {%- else -%}
    <div class="cart-page__empty">
      <p>{{ 'cart.empty' | t }}</p>
      <a href="{{ routes.all_products_collection_url }}" class="btn btn--primary">
        {{ 'cart.continue_shopping' | t }}
      </a>
    </div>
  {%- endif -%}
</section>

{% stylesheet %}
  .cart-page {
    max-width: 70rem;
    margin: 0 auto;
  }

  .cart-page__title {
    font-size: var(--heading-2xl);
    text-align: center;
    margin-bottom: var(--gap-xl);
  }

  .cart-page__form {
    display: grid;
    grid-template-columns: 1fr 350px;
    gap: var(--gap-xl);
    align-items: start;
  }

  .cart-page__items {
    display: flex;
    flex-direction: column;
    gap: var(--gap-md);
  }

  .cart-item {
    display: flex;
    gap: var(--gap-md);
    padding-bottom: var(--gap-md);
    border-bottom: 1px solid var(--color-border);
  }

  .cart-item__image {
    flex-shrink: 0;
    width: 8rem;
    aspect-ratio: 3 / 4;
    background-color: var(--color-bg-alt);
    overflow: hidden;
  }

  .cart-item__image img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .cart-item__placeholder {
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 1rem;
  }

  .cart-item__placeholder svg {
    width: 100%;
    opacity: 0.3;
  }

  .cart-item__details {
    flex: 1;
    display: grid;
    grid-template-columns: 1fr auto auto auto;
    gap: var(--gap-md);
    align-items: start;
  }

  .cart-item__info {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .cart-item__title {
    font-size: var(--text-base);
    font-weight: 500;
    text-decoration: none;
    color: inherit;
  }

  .cart-item__title:hover {
    color: var(--color-accent);
  }

  .cart-item__variant {
    font-size: var(--text-sm);
    color: var(--color-muted);
    margin: 0;
  }

  .cart-item__price {
    font-size: var(--text-sm);
    margin: 0;
  }

  .cart-item__quantity-input {
    display: flex;
    align-items: center;
    border: 1px solid var(--color-border);
  }

  .cart-item__quantity-btn {
    width: 2rem;
    height: 2rem;
    display: flex;
    align-items: center;
    justify-content: center;
    background: none;
    border: none;
    cursor: pointer;
    transition: background-color var(--animation-duration) var(--animation-easing);
  }

  .cart-item__quantity-btn:hover {
    background-color: var(--color-bg-alt);
  }

  .cart-item__quantity-field {
    width: 3rem;
    height: 2rem;
    text-align: center;
    border: none;
    border-left: 1px solid var(--color-border);
    border-right: 1px solid var(--color-border);
    font-size: var(--text-sm);
    -moz-appearance: textfield;
  }

  .cart-item__quantity-field::-webkit-outer-spin-button,
  .cart-item__quantity-field::-webkit-inner-spin-button {
    -webkit-appearance: none;
  }

  .cart-item__total {
    text-align: right;
    min-width: 5rem;
  }

  .cart-item__line-price {
    font-weight: 500;
  }

  .cart-item__remove {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 2rem;
    height: 2rem;
    color: var(--color-muted);
    transition: color var(--animation-duration) var(--animation-easing);
  }

  .cart-item__remove:hover {
    color: var(--color-text);
  }

  .cart-summary {
    position: sticky;
    top: calc(5rem + var(--gap-lg));
    padding: var(--gap-lg);
    background-color: var(--color-bg-alt);
  }

  .cart-summary__row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding-bottom: var(--gap-md);
    margin-bottom: var(--gap-md);
    border-bottom: 1px solid var(--color-border);
  }

  .cart-summary__subtotal {
    font-size: var(--heading-md);
    font-weight: 500;
  }

  .cart-summary__note {
    font-size: var(--text-sm);
    color: var(--color-muted);
    margin: 0 0 var(--gap-lg);
  }

  .cart-summary__actions {
    display: flex;
    flex-direction: column;
    gap: var(--gap-sm);
  }

  .cart-summary__update,
  .cart-summary__checkout {
    width: 100%;
  }

  .cart-summary__continue {
    display: block;
    text-align: center;
    margin-top: var(--gap-md);
    font-size: var(--text-sm);
    color: var(--color-muted);
  }

  .cart-page__empty {
    text-align: center;
    padding: var(--gap-2xl);
  }

  .cart-page__empty p {
    font-size: var(--text-lg);
    color: var(--color-muted);
    margin-bottom: var(--gap-lg);
  }

  @media (max-width: 1024px) {
    .cart-page__form {
      grid-template-columns: 1fr;
    }

    .cart-summary {
      position: static;
    }
  }

  @media (max-width: 640px) {
    .cart-item__details {
      grid-template-columns: 1fr;
      gap: var(--gap-sm);
    }

    .cart-item__total {
      text-align: left;
    }

    .cart-item__remove {
      position: absolute;
      top: 0;
      right: 0;
    }

    .cart-item {
      position: relative;
    }
  }
{% endstylesheet %}

{% javascript %}
  const quantityInputs = document.querySelectorAll('.cart-item__quantity-field');

  document.querySelectorAll('[data-quantity-minus]').forEach(btn => {
    btn.addEventListener('click', () => {
      const input = btn.parentElement.querySelector('input');
      const value = parseInt(input.value) || 1;
      if (value > 0) input.value = value - 1;
    });
  });

  document.querySelectorAll('[data-quantity-plus]').forEach(btn => {
    btn.addEventListener('click', () => {
      const input = btn.parentElement.querySelector('input');
      const value = parseInt(input.value) || 0;
      input.value = value + 1;
    });
  });
{% endjavascript %}

{% schema %}
{
  "name": "t:general.cart",
  "settings": []
}
{% endschema %}
