{% doc %}
  Renders a product card with image, title, and price.

  @param {product} product - The product object to display
  @param {boolean} [show_vendor] - Whether to show the product vendor
  @param {boolean} [show_secondary_image] - Whether to show secondary image on hover
  @param {string} [image_ratio] - Image aspect ratio: 'square', 'portrait', 'landscape' (default: 'portrait')
  @param {string} [alignment] - Text alignment: 'left', 'center', 'right' (default: 'left')

  @example
  {% render 'product-card', product: product %}
  {% render 'product-card', product: product, show_vendor: true, image_ratio: 'square' %}
{% enddoc %}

{%- liquid
  assign ratio_class = 'product-card__image--portrait'
  if image_ratio == 'square'
    assign ratio_class = 'product-card__image--square'
  elsif image_ratio == 'landscape'
    assign ratio_class = 'product-card__image--landscape'
  endif

  assign align_class = ''
  if alignment == 'center'
    assign align_class = 'product-card--center'
  elsif alignment == 'right'
    assign align_class = 'product-card--right'
  endif
-%}

<article class="product-card {{ align_class }}">
  <a href="{{ product.url }}" class="product-card__link">
    <div class="product-card__image {{ ratio_class }}">
      {%- if product.featured_image -%}
        {{ product.featured_image | image_url: width: 600 | image_tag: loading: 'lazy', class: 'product-card__img product-card__img--primary' }}
        {%- if show_secondary_image and product.images[1] -%}
          {{ product.images[1] | image_url: width: 600 | image_tag: loading: 'lazy', class: 'product-card__img product-card__img--secondary' }}
        {%- endif -%}
      {%- else -%}
        <div class="product-card__placeholder">
          {{ 'product-1' | placeholder_svg_tag }}
        </div>
      {%- endif -%}

      {%- if product.compare_at_price > product.price -%}
        <span class="product-card__badge">{{ 'products.on_sale' | t }}</span>
      {%- endif -%}

      {%- unless product.available -%}
        <span class="product-card__badge product-card__badge--sold-out">{{ 'products.sold_out' | t }}</span>
      {%- endunless -%}
    </div>

    <div class="product-card__info">
      {%- if show_vendor and product.vendor -%}
        <span class="product-card__vendor">{{ product.vendor }}</span>
      {%- endif -%}

      <h3 class="product-card__title">{{ product.title }}</h3>

      <div class="product-card__price">
        {%- if product.compare_at_price > product.price -%}
          <span class="product-card__price--compare">{{ product.compare_at_price | money }}</span>
        {%- endif -%}
        <span class="product-card__price--current {% if product.compare_at_price > product.price %}product-card__price--sale{% endif %}">
          {{ product.price | money }}
        </span>
      </div>
    </div>
  </a>
</article>

{% stylesheet %}
  .product-card {
    position: relative;
  }

  .product-card__link {
    display: block;
    text-decoration: none;
    color: inherit;
  }

  .product-card__image {
    position: relative;
    overflow: hidden;
    background-color: var(--color-bg-alt);
    margin-bottom: var(--gap-md);
  }

  .product-card__image--portrait { aspect-ratio: 3 / 4; }
  .product-card__image--square { aspect-ratio: 1 / 1; }
  .product-card__image--landscape { aspect-ratio: 4 / 3; }

  .product-card__img {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    transition: opacity var(--animation-duration) var(--animation-easing),
                transform var(--animation-duration) var(--animation-easing);
  }

  .product-card__img--secondary {
    opacity: 0;
  }

  .product-card:hover .product-card__img--primary {
    opacity: 0;
  }

  .product-card:hover .product-card__img--secondary {
    opacity: 1;
  }

  .product-card:hover .product-card__img {
    transform: scale(1.03);
  }

  .product-card__placeholder {
    position: absolute;
    inset: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 2rem;
  }

  .product-card__placeholder svg {
    width: 100%;
    height: auto;
    opacity: 0.3;
  }

  .product-card__badge {
    position: absolute;
    top: var(--gap-sm);
    left: var(--gap-sm);
    padding: 0.25rem 0.75rem;
    font-size: var(--text-xs);
    font-weight: 500;
    letter-spacing: var(--letter-spacing-wide);
    text-transform: uppercase;
    background-color: var(--color-accent);
    color: var(--color-accent-contrast);
  }

  .product-card__badge--sold-out {
    background-color: var(--color-muted);
  }

  .product-card__info {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .product-card__vendor {
    font-size: var(--text-xs);
    text-transform: uppercase;
    letter-spacing: var(--letter-spacing-wide);
    color: var(--color-muted);
  }

  .product-card__title {
    font-family: var(--font-body);
    font-size: var(--text-base);
    font-weight: 400;
    margin: 0;
    transition: color var(--animation-duration) var(--animation-easing);
  }

  .product-card:hover .product-card__title {
    color: var(--color-accent);
  }

  .product-card__price {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    font-size: var(--text-sm);
    margin-top: 0.25rem;
  }

  .product-card__price--compare {
    text-decoration: line-through;
    color: var(--color-muted);
  }

  .product-card__price--sale {
    color: var(--color-accent);
  }

  .product-card--center {
    text-align: center;
  }

  .product-card--center .product-card__info {
    align-items: center;
  }

  .product-card--center .product-card__badge {
    left: 50%;
    transform: translateX(-50%);
  }

  .product-card--right {
    text-align: right;
  }

  .product-card--right .product-card__info {
    align-items: flex-end;
  }

  .product-card--right .product-card__badge {
    left: auto;
    right: var(--gap-sm);
  }
{% endstylesheet %}
